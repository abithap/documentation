<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="HP2.0LBaaS">
  <title>HPE Helion <tm tmtype="reg">OpenStack</tm> 2.0 LBaaS Configuration</title>
  <body>
    <p>HPE Helion <tm tmtype="reg">OpenStack</tm> 2.0 LBaaS Configuration</p>
    <p>This document describes the configuration process and requirements for the HPE Helion
      <tm tmtype="reg">OpenStack</tm> 2.0 Load Balancing as a Service module.</p>
    <p>
      <ul id="LBaaSlist">
        <li><xref href="lbaas.dita#HP2.0LBaaS/Prerequisites">Prerequisites</xref></li>
        <li><xref href="lbaas.dita#HP2.0LBaaS/Configuration">Configuration</xref></li>
        <li><xref href="lbaas.dita#HP2.0LBaaS/MoreInfo">More Information</xref></li>
      </ul>
    </p>
    
    <section id="Prerequisites">
      <title>Prerequisites</title>
      <p>HPE Helion <tm tmtype="reg">OpenStack</tm> must be installed. </p>
    </section>
    <section id="Configuration">
      <title>Configuration</title>
      <p>HPE Helion <tm tmtype="reg">OpenStack</tm> 2.0 LBaaS Configuration</p>
      
      <p>You can create a new Load Balancer by executing the following command from the deployer.
        The load balancing service is installed by default and does not require installation before
        configuration. Before running the commands, be sure you have your private network set up
        with a router, namespaces and active virtual machines.</p>
      <ol>
        <li>You can list the available services/agents on the system with the <codeph>agent-list</codeph> command.
          <codeblock>neutron agent-list</codeblock></li>
        <li>You can list the available networks on the system with the <codeph>net-list</codeph> command.
          <codeblock>neutron net-list</codeblock></li>
        <li>Using the Compute command-line client, <codeph>nova</codeph>, you can display the available virtual machines and their IP addresses 
          by using the <codeph>list</codeph> command.  
          <codeblock>nova list</codeblock></li>
        <li>Create the new load balancer using the <codeph>lbass-loadbalancer-create</codeph> command and giving the load balancer a name and network.
          <codeblock>neutron lbass-loadbalancer-create --name lb sub</codeblock></li>
        <li>Create a new listener for the load balancer using the <codeph>lbass-listener-create</codeph> command and giving the listener
          the name of the load balancer, the protocol, the protocol port and a name for the listener.
          <codeblock>neutron lbass-listener-create --loadbalancer lb --protocol HTTP --protocol-port=80 --name listener</codeblock></li>
        <li>Create a new pool for the load balancer using the <codeph>lbass-pool-create</codeph> command.  Creating a new pool requires
          the load balancing algorithm, the name of the listener, the protocol and a name for the pool.
          <codeblock>neutron lbass-pool-create --lb-algorithm ROUND_ROBIN --listener listener --protocol HTTP --name pool</codeblock></li>
        <li>You can add members to the load balancer pool by running the <codeph>lbass-member-create</codeph> command. The command requires the
          subnet, IP address, protocol port and the name of the pool for each virtual machine you'd like to include into the load balancer pool.
          <codeblock>neutron lbaas-member-create --subnet sub --address 10.0.0.5 --protocol-port 80 pool</codeblock></li>
        <li>Display the current state of the load balancer and values with <codeph>lbass-loadbalancer-show</codeph>.
          <codeblock>neutron lbaas-loadbalancer-show lb</codeblock></li>
      </ol>
      <p>You can test the load balancer configuration by adding the IP address of the load balancer to the environment variable <codeph>no_proxy</codeph> and executing
        <codeph>curl</codeph>.</p>
      <ol>
        <li>Add load balancer IP to no_proxy environment variable. <codeblock>export no_proxy=$no_proxy,10.0.0.7</codeblock></li>
        <li>Run curl with load balancer IP address.<codeblock>curl 10.0.0.7</codeblock></li>
      </ol>
    </section>
    <section id="MoreInfo">
      <title>More Information</title>
      <p>For more information on the neutron command-line interface (CLI) and load balancing, see the OpenStack networking command-line client
      reference: <xref href="http://docs.openstack.org/cli-reference/content/neutronclient_commands.html" scope="external" format="html"></xref></p>
    </section>
  </body>
</topic>
