<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="topic_cw2_xcg_bt">
  <title>Configure and Install Ceph</title>
  <body>
    <p>This section describes the procedure to configure and  install Ceph services.</p>
    <p><b>Limitation</b></p>
    <p>
      <ol id="ol_b4j_dng_bt">
        <li>The OSD role cannot be changed. If you need to provision more disks on a given OSD node,
          ensure that you remove the earlier disks.</li>
      </ol>
    </p>
    <p><b>Pre-requisites</b></p>
    <p>
      <ul id="ul_aqj_3fg_bt">
        <li>Configure Processor has to be executed. When you execute the configure processor, the
            <codeph>hosts/verb_hosts</codeph> file is generated and two sections 'CEP-MON:children'
          and 'CEP-OSD:children' are added. The<codeph>hosts/verb_hosts</codeph>  file list the host
          on which the corresponding services will be installed.</li>
        <li>
          <p>Config processor should have executed, which will generate the hosts/verb_hosts file
            with 'CEP-MON:children' and 'CEP-OSD:children' sections, which will list the hosts on
            which corresponding services will be installed. Otherwise, manually create the sections
            and list the appropriate hosts under the corresponding sections.</p>
          <p><b>Procedure to install Ceph</b></p>
          <p>
            <ol id="ol_jhq_rgg_bt">
              <li>Login in as a Stack user and execute the following command from the
                deployer:<codeblock>cd helion/hlm/ansible</codeblock></li>
              <li>Configure OSDs in  <codeph>roles/CEP-OSD/defaults/main.yml</codeph>. You can set
                the OSD configuration as per the environment.</li>
              <li>Specify the data disks for Ceph storage in
                  <codeph>roles/CEP-OSD/vars/ceph_disk_model.yml</codeph></li>
              <li>(Optional) Specify the journal disk to be used for a specific data disk. If you do
                not specify a journal disk then a separate partition is created on the data disk,
                which is used for journalling. A sample of disk model is as
                  follows:<codeblock>---

osd_disk_model:

  device_groups:

    - name: ceph-osd-data-and-journal

      devices:

        - name: /dev/sdd

      consumer:

        name: ceph

        attrs:

          usage: data

          journal_disk: /dev/sdf</codeblock><note>In
                  the above sample, the consumer name <b>ceph</b> is standard. This indicates that
                  the drive should be consumed by Ceph.</note><note>You can repeat
                    <codeph>ceph-osd-data-and-journal</codeph> for each data disk on an OSD
                  node.</note></li>
              <li>Execute the following command to install
                ceph:<codeblock>ansible-playbook -i hosts/verb_hosts ceph-deploy.yml</codeblock></li>
            </ol>
          </p>
        </li>
      </ul>
    </p>
  </body>
</topic>
