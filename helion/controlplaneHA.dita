<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="topic_g54_bzb_bt">
  <title>Control Plane High Availability</title>
  <body>
    <p>The mid-size model is intended as a template for a moderate sized cloud. The Control plane is
      made up of multiple server clusters to provide sufficient computational, network and IOPS
      capacity for a mid-size production style cloud.</p>
    <p>The Helion mid-size model is architected as follows: </p>
    <p><b>Control Plane</b><ul id="ul_dq4_jbc_bt">
        <li>Core cluster: Runs Core OpenStack Services, (e.g. keystone, nova api, gance api, netron
          api, horizon, heat api). Default configuration is three nodes of role type ROLE-CONTROLLER </li>
        <li>Metering and Monitoring cluster: Runs the OpenStack Services for metering and monitoring
          (e.g. celiometer, monasca and logging). Default configuration is three nodes of role type
          ROLE-CONTROLLER</li>
        <li>Database and Message Queue Cluster: Runs clustered MySQL and RabbitMQ services to
          support the Helion cloud infrastructure. Default configuration is three nodes of role type
          ROLE-DBMQ. Three nodes are required for high availability.</li>
        <li>Swift PAC cluster: Runs the Swift Proxy, Account and Container services. Default
          configuration is three nodes or role type ROLE-SWPAC.</li>
      </ul>
    </p>
    <section><title>Resource Nodes</title></section>
    <p>Three resource pools are defined:<ul id="ul_mqk_mbc_bt">
        <li>Compute: Runs nova compute and associated services.Runs on nodes of role type
          ROLE-COMPUTE. The example lists 3 nodes, one node is required at a minimum.</li>
        <li>VSA: Runs the StoreVirtual VSA appliance.Runs on nodes of role type ROLE-VSA.One node
          minimum is required for demo purposes, three for high availability.The example lists 1
          node.</li>
        <li>Object: Runs the Swiftobject service.Runs on nodes of role type ROLE-SWPAC.The minimum
          node count should match your sift replica count.The example lists 3 nodes.</li>
      </ul></p>
    <section>
      <title>Deployer Node</title>
      <p>A dedicated deployer node is required. (Beta 1, this will be removed in a later Beta). The
        minimum node count required to run the model un-modified is 20 nodes. This can be reduced by
        consolidating servies on the control plane clusters. </p>
    </section>
    <section><title>Networking</title>
      <p>The example requires the following networks: <ul>
          <li>IMPI/iLO network, connected to the deployer and the IPMI/iLO ports of all servers</li>
          <li>A network connected to a dedicated NIC on each server used to install the OS and
            install and configure Helion. In a future Beta release this network can be subsumed into
            system networks (below).</li>
          <li>A pair of bonded NICs which are used used by the following networks: <ul>
              <li>External API - This is the network that users will use to make requests to the
                cloud</li>
              <li>External VM - This is the network that will be used to provide access to VMs (via
                floating IP addresses)</li>
              <li>Guest - This is the network that will carry traffic between VMs on private
                networks within the cloud</li>
              <li>Cloud Management - This is the network that will be used for all internal traffic
                between the cloud services. In the example this is shown as untagged. It can be
                tagged if needed.</li>
              <li>iSCSI - This network is sued to host all iSCSI (Cinder back end) traffic between
                Nova compute and the VSA servers</li>
              <li>SWIFT - This network is used for internal Swift comunications between the Swift
                servers</li>
            </ul>
            <p>Note that the EXTERNAL\_API network must be reachable from the EXTERNAL\_VM network
              if you want VMS to be able to make API calls to the cloud.</p><p>An example set of
              networks are defined in ***data/networks.yml***. You will need to modify this file to
              reflect your environment.</p><p>The example uses eth2 for the install network and eth3
              and eth4 for the bonded network. If you need to modify these for your environment they
              are defined in ***data/net_interfaces.yml***</p>
          </li>
        </ul></p></section>
    <section><title>Adapting the mid-size model to fit your environment</title>
      <p>The minimum set of changes you need to make to adapt the model for your environment are:<ul>
          <li>Update baremetalConfig.yml to list the details of your baremetal servers. You need to
            perform this step if you are using the HLM supplied Cobber playbooks to install hLinux
            on your servers.</li>
          <li>Update servers.yml,: This step is not necessary if you are using the HLM supplied
            Cobber playbooks to install hLinux on your servers (From Beta 1 onwards ?). As this file
            will be automatically generated. However if you are using some other method to provision
            your servers then this file must be provided/updated.</li>
          <li>Update the networks.yml file to replace network CIDRs and VLANs with site specific
            values.</li>
          <li>Update the disk models to reflect any server disk configuration changes you want to
            make. Disk models are provided as follows:<ul>
              <li>DISK SET CONTROLLER: Minimum 1 disk</li>
              <li>DISK SET DBMQ: Minimum 3 disks</li>
              <li>DISK SET COMPUTE: Minimum 2 disks</li>
              <li>DISK SET SWPAC: Minimum 3 disks</li>
              <li>DISK SET SWOBJ: Minimum 3 disks</li>
              <li>DISK SET VSA: Minimum 3 disks</li>
            </ul>
          </li>
          <li>Update the net interfaces.yml file to match the server NICs used in your
            configuration. This file has a separate interface model definition for each of the following:<ul>
              <li>INTERFACE SET CONTROLLER</li>
              <li>INTERFACE SET VSA</li>
              <li>INTERFACE SET DBMQ</li>
              <li>INTERFACE SET SWPAC</li>
              <li>INTERFACE SET SWOBJ</li>
              <li>INTERFACE SET COMPUTE</li>
            </ul></li>
        </ul></p>
    </section>
  </body>
</topic>
