<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" >
<topic xml:lang="en-us" id="topic10581">
  <title>HP Helion <tm tmtype="reg">OpenStack</tm> Carrier Grade 1.1: Deploying the VRS vApp</title>
  <prolog>
    <metadata>
      <othermeta name="layout" content="default"/>
      <othermeta name="product-version" content="HP Helion Openstack Carreir Grade 1.1"/>
      <othermeta name="role" content="Storage Administrator"/>
      <othermeta name="role" content="Storage Architect"/>
      <othermeta name="role" content="Michael B"/>
      <othermeta name="product-version1" content="HP Helion Openstack Carreir Grade 1.1"/>
    </metadata>
  </prolog>
  <body>
    <p><i>Return to the Installing the <xref
          href="carrier-grade-install-kvm-esx-GA.dita#topic10581/create-a-new-cloud-template-and-bring-the-cloud-nodes-up"
          >KVM + ESX Deployment</xref>.</i></p>

    <p>The HP Helion OpenStack Carrier Grade in the KVM + ESX Deployment requires the VSvApp. One
      VRS vApp is required for each ESX host. vmotion must be disabled to prevent the VRS VM from
      moving from the ESX host.</p>
    <section>
      <p> To install the VRSvApp:</p>
      <ol id="ol_hf4_nvy_zs">
        <li>Copy the downloaded <codeph>DCN-VRS-VMware-3.0R7.zip</codeph> file from HLM host to VSD
          node in the <codeph>/opt/vsd</codeph> directory. For more information on downloading DCN
          files, see <xref href="carrier-grade-install-pb-prereqs-GA.dita#topic7148/download-esx"
            >Download packages for KVM + ESX</xref>.</li>
        <li>Extract <codeph>DCN-VRS-VMware-3.0R7.zip</codeph> file to any directory. </li>
        <li>Change to the directory where you extracted the files, for
            example:<codeblock>cd /opt/vsd/CloudMgmt-vmware-working/</codeblock><p>The
              <codeph>vrs-metafile.config</codeph> file is in the extracted files. </p></li>
        <li>Modify the <codeph>vrs-metafile.config</codeph> using values appropriate for your
          environment. A example has been provided below.</li>
        <li>Run the command to deploy the template using the example below after making changes to
          file paths to match your environment, vcenter username, vcenter password and vcenter ip
            <codeblock>./cli.bash deploy_vrs [-d &lt;ATASTORE>] -f &lt;PATH> -m &lt;FILE> -p &lt;PASSWORD> [-r &lt;RESOURCEPOOL>] –u &lt;USRNAME> --url &lt;URL></codeblock><p>Where:</p><codeblock>usage: 
-d,--datastore &lt;DATASTORE>         Datastore name or moref. (Optional)
-f,--path &lt;PATH>                   VRS template path.
-m,--metafile &lt;FILE>               Meta file defining VRS property values.
-p,--password &lt;PASSWORD>           vCenter password.
-r,--resourcepool &lt;RESOURCEPOOL>   Resource pool name or moref. (Optional)
-u,--username &lt;USRNAME>            vCenter user name.
--url &lt;URL>                     vCenter url (example: https://localhost/sdk)          </codeblock></li>
      </ol>
      <p> </p>
      <p><b>Syntax Help</b></p>
      <codeblock>usage: deploy_vrs [-d &lt;DATASTORE&gt;] -f &lt;PATH&gt; -m &lt;FILE&gt; -p &lt;PASSWORD&gt; [-r &lt;RESOURCEPOOL&gt;] –u &lt;USRNAME&gt; --url &lt;URL&gt;
-d,--datastore &lt;DATASTORE&gt; Datastore name or moref. (Optional)
-f,--path &lt;PATH&gt; VRS template path.
-m,--metafile &lt;FILE&gt; Meta file defining VRS property values.
-p,--password &lt;PASSWORD&gt; vCenter password.
-r,--resourcepool &lt;RESOURCEPOOL&gt; Resource pool name or moref. (Optional)
-u,--username &lt;USRNAME&gt; vCenter user name.
--url &lt;URL&gt; vCenter url (example: <xref href="https://localhost/sdk" format="html" scope="external">https://localhost/sdk</xref>)</codeblock>
      <p><b>Example <codeph>vrs-metafile.config</codeph> file</b></p>
      <p>The following is a sample <codeph>vrs-metafile.config</codeph> that you can use to create a
        file on your local system. Note that the IP addresses have been masked for security
        purposes. You must use proper IP addresses in your file.</p>
      <codeblock>      {
          "servers":{
            "vcenter":{
              "ip":"10.x.x.x",
              "user":"root",
              "password":"vmware"
            },
            "hypervisor1":{
              "ip":"10.x.x.x",
              "user":"root",
              "password":"vmware"
            }
          },
          "subnets":{
            "mgmtSubnet1":{
              "ip":"10.x.x.x",
              "netmask":"255.255.255.0",
              "gateway":"10.x.x.x"
              },
              "dataSubNet1":{
                "ip":"192.x.x.x",
                "netmask":"255.255.255.0",
                "gateway":"192.x.x.x"
              }
            },
            "ipMappings":{
              "controller":"192.x.x.x",
                "dns1":"10..x.x.x",
                "dns2":"16..x.x.x",
                "ntpServer":"10.x.x.x"
            },
            "properties":[
              {
                "vcenter_":"vcenter",
                "hypervisor_":"hypervisor1",
                "primaryController_":"controller",
                "secondaryController_":"controller",
                "powerOn": "false",
                "allowMgmtDhcp": "false",
                "mgmtDns1_":"dns1",
                "mgmtDns2_":"dns2",
                "mgmtNetwork_":"mgmtSubnet1",
                "separateDataNetwork":"true",
                "allowDataDhcp":"false",
                "dataNetwork_":"dataSubNet1",
                "dataDns1_":"dns1",
                "dataDns2_":"dns2",
                "dataNetworkPortgroup":"DVRS Datapath",
                "mgmtNetworkPortgroup":"Cloud Lab Management",
                "vmNetworkPortgroup":"dvPortGroup",
                "ntpServer1_":"ntpServer",
                "ntpServer2_":"ntpServer",
                "multicastSourcePortgroup":"DVRS Datapath",
                "requireNuageMetadata":"false",
                "personality":"VRS"
            }
          ]
        }
        </codeblock>
      <p><b>Notes and definitions regarding VRS vApp</b></p>
      <ul id="ul_if4_nvy_zs">
        <li>vCenter=vcenter Ip address</li>
        <li>Hypervisor=ESX Host that this VRS vApp will be deployed</li>
        <li>mgmtSubnet1=CLM network</li>
        <li>dataSubNet1=TUL network</li>
        <li>controller=VSC server ip</li>
        <li>Default user name and password for the VRS vm: ,<codeph>root/UFXCr4733F</codeph></li></ul>
      <p><i>Return to the Installing the <xref
            href="carrier-grade-install-kvm-esx-GA.dita#topic10581/create-a-new-cloud-template-and-bring-the-cloud-nodes-up"
            >KVM + ESX Deployment</xref>.</i></p>
    </section>
  </body>
</topic>
