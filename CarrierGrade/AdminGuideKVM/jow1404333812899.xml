<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task-wr PUBLIC "-//WindRiver.com//DTD DITA 1.2 Wind River General Task//EN" "task-wr.dtd">
<task-wr ditaarch:DITAArchVersion="1.2" domains="(topic task task-wr)                            (topic hi-d)                            (topic pr-d)                            (topic sw-d)                            (topic ui-d)                            (topic wr-sw-d)                            (topic xml-d)   " id="jow1404333812899" xml:lang="en-us" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
    <!-- Modification History
        
-->
    <title id="1">Creating an In/Out Autoscaling Resource</title>
    <shortdesc id="2">The <filepath id="3">CPUScale.yaml</filepath> template
        illustrates the use of a template to create an in/out autoscaling resource. It also shows
        how to customize VM instance images at startup, and how to use custom performance monitoring
        on the guest.</shortdesc>
    <prolog>
        <author id="4">Jim Owens</author>
    </prolog>
    <taskbody>
        <context id="context_N10023_N10020_N10001" id="5">
            <p id="6">This CFN template creates a server group based on a standard instance
                type, specified as a parameter.  The template includes a <nameliteral id="7">UserData</nameliteral> section that customizes each instance at launch by
                defining a CPU meter and setting it to push information to the controller at regular
                intervals. Instances are added or removed based on this information.</p>
            <p id="165">For in/out scaling, the CPU measurement uses a <nameliteral id="166">cpu_util</nameliteral>
                meter, which takes into account the total number of available vCPUS for the instance
                when measuring usage.</p>
            <p id="9">Use an <nameliteral id="10">admin</nameliteral> account to run
                this template.</p>
        </context>
        <prereq id="prereq_N10030_N10020_N10001" id="8">
            <p id="85">To use the autoscaling resource in this example, the following
                requirements must be satisfied:</p>
            <ul id="ul_q4q_5kg_w4">
                <li id="86">
                    <p id="87"><libraryname id="167">cloud-init</libraryname> must be
                        available on the guest image. This is required so that the guest can process
                        the <nameliteral id="13">UserData</nameliteral> configuration
                        supplied at launch. The example image provided with HP Helion OpenStack Carrier Grade includes
                            <libraryname id="168">cloud-init</libraryname>. </p>
                </li>
                <li id="88">
                    <p id="14"><libraryname id="169">heat-cfntools</libraryname>
                        must be available on the guest image. This is required so that the guest can
                        push information to Ceilometer on the controller. The example image provided
                        with HP Helion OpenStack Carrier Grade includes <libraryname id="170">heat-cfntools</libraryname>.</p>
                </li>
                <li id="89">
                    <p id="16">the guest can send data to the controller using the IP
                        address specified in <filepath id="17">/etc/heat/heat.conf</filepath>.</p>
                </li>
            </ul>
        </prereq>
        <steps>
            <step id="step_N1005C_N10059_N10020_N10001" id="18">
                <cmd id="19">Collect the required parameter values for this template.</cmd>
                <substeps id="substeps_wqc_mlv_34">
                    <substep id="23">
                        <cmd conref="jow1404333809730.xml#jow1404333809730/locate-flavor" id="24"/>
                    </substep>
                    <substep id="25">
                        <cmd conref="jow1404333809730.xml#jow1404333809730/locate-keypair" id="26"/>
                    </substep>
                    <substep id="27">
                        <cmd conref="jow1404333809730.xml#jow1404333809730/locate-image" id="28"/>
                    </substep>
                    <substep id="171">
                        <cmd id="172">On the <menucascade id="173">
                                <uicontrol id="175">Admin</uicontrol>
                                <uicontrol id="41">System Panel</uicontrol>
                                <uicontrol id="177">Networks</uicontrol>
                            </menucascade> page, click the <uicontrol id="179">Name</uicontrol> of each required network in turn, in order to open
                            the Network Overview page and obtain the network <uicontrol id="181">ID</uicontrol>. For this template, a public network
                            ID and an internal network ID are required.</cmd>
                    </substep>
                </substeps>
            </step>
            <step conref="jow1404832975002.xml#jow1404832975002/open-stack-list" id="step_N10096_N10059_N10020_N10001" id="180"><cmd id="32"/></step>
            <step conref="jow1404833049288.xml#jow1404833049288/launch-stack" id="step_N1009D_N10059_N10020_N10001" id="33"><cmd id="34"/></step>
            
            <step id="step_N100A4_N10059_N10020_N10001" id="35">
                <cmd id="36">Select<uicontrol id="174"> File</uicontrol>, then click <uicontrol id="38">Browse</uicontrol>
                    and select <filepath id="176">CPUScale.yaml</filepath> from the local disk.</cmd>
            </step>
            <step id="step_N100CA_N10059_N10020_N10001" id="178">
                <cmd id="44">Use the <wintitle id="182">Launch Stack</wintitle> form to provide the required
                    parameter values for the template. </cmd>
                <info id="46">
                    <fig id="fig_N100D4_N100D1_N100C6_N10059_N10020_N10001" id="47">
                        <image alt="CPUScale Launch Stack form" href="jow1404333811339.image" id="image_dvz_1wj_j4" id="48" width="4in"/>
                    </fig>
                    <note id="note_N100E1_N100D1_N100C6_N10059_N10020_N10001" id="49">
                        <p id="50">The parameters are presented in a single column. This image has been
                            edited to present them in two columns.</p>
                    </note>
                </info>
            </step>
            <step id="step_N100F1_N10059_N10020_N10001" importance="optional" id="51">
                <cmd id="52">Adjust existing values to meet your requirements.</cmd>
                <choicetable id="choicetable_nqn_msw_34" keycol="1" relcolwidth="1.0* 2.0*">
                    <chrow>
                        <choption id="90">
                            <p id="92"><uicontrol id="94">KeyName</uicontrol></p>
                        </choption>
                        <chdesc id="96">
                            <p id="98">The <uicontrol id="100">KeyPair</uicontrol>
                                name from the<wintitle id="101"> Access &amp;
                                    Security</wintitle> page.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="102">
                            <p id="104"><uicontrol id="106">ViFModel</uicontrol></p>
                        </choption>
                        <chdesc id="108">
                            <p id="110">The virtual interface model to use. For valid
                                choices, see <cite id="164">Multiple NIC Support</cite> in
                                    <xref href="jow1404333807231.xml" id="163"/>.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="118">
                            <p id="120"><uicontrol id="122">InstanceType</uicontrol></p>
                        </choption>
                        <chdesc id="124">
                            <p id="126">The <uicontrol id="131">Flavor
                                    Name</uicontrol> from the <wintitle id="132">Flavors</wintitle> page.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="133">
                            <p id="135"><uicontrol id="137">ImageId</uicontrol></p>
                        </choption>
                        <chdesc id="139">
                            <p id="127">The <uicontrol id="141">Image
                                    Name</uicontrol> from the <wintitle id="142">Images</wintitle> page.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="143">
                            <p id="145"><uicontrol id="147">PublicNetId</uicontrol></p>
                        </choption>
                        <chdesc id="149">
                            <p id="128">The <uicontrol id="151">ID</uicontrol> from
                                the <wintitle id="152">Network Overview</wintitle> page.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="153">
                            <p id="155"><uicontrol id="157">InternalNetId</uicontrol></p>
                        </choption>
                        <chdesc id="159">
                            <p id="129">The <uicontrol id="161">ID</uicontrol> from
                                the <wintitle id="162">Network Overview</wintitle> page.
                                <!-- this and the similar entry above need attention. We need two network IDs (or are the Names enough?) when we collect the parameters. --></p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="91">
                            <p id="93"><uicontrol id="95">MinClusterSize</uicontrol></p>
                        </choption>
                        <chdesc id="97">
                            <p id="99">The minimum number of VMs to launch. The stack cannot
                                autoscale below this value.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="103">
                            <p id="105"><uicontrol id="107">MaxClusterSize</uicontrol></p>
                        </choption>
                        <chdesc id="109">
                            <p id="111">The maximum number of VMs that can be launched.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="119">
                            <p id="121"><uicontrol id="123">CustomMeterName</uicontrol></p>
                        </choption>
                        <chdesc id="125">
                            <p id="130">The name of a custom Ceilometer metric to store. For
                                information about custom metrics, see <xref href="jow1404916152577.xml" id="84"/>.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="134">
                            <p id="136"><uicontrol id="138">CustomMeterUnit</uicontrol></p>
                        </choption>
                        <chdesc id="140">
                            <p id="73">The unit of measurement to display for the custom
                                metric; for example, 'Percent'.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="144">
                            <p id="146"><uicontrol id="148">MetricHighWaterMark</uicontrol></p>
                        </choption>
                        <chdesc id="150">
                            <p id="78">The value that triggers autoscaling to add
                                resources.</p>
                        </chdesc>
                    </chrow>
                    <chrow>
                        <choption id="154">
                            <p id="156"><uicontrol id="158">MetricLowWaterMark</uicontrol></p>
                        </choption>
                        <chdesc id="160">
                            <p id="83">The value that triggers autoscaling to remove
                                resources.</p>
                        </chdesc>
                    </chrow>
                </choicetable>
            </step>
        </steps>
    </taskbody>
</task-wr>