<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE concept-wr PUBLIC "-//WindRiver.com//DTD DITA 1.2 Wind River Concept//EN" "concept-wr.dtd">
<concept-wr domains="(topic concept concept-wr)                            (topic hi-d)                            (topic indexing-d)                            (topic pr-d)                            (topic sw-d)                            (topic ui-d)                            (topic wr-sw-d)                            (topic xml-d)   " id="jow1404333645456" xml:lang="en-us" xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/">
    <!-- Modification History
   -->
    <title id="1">Resource Usage</title>
    <shortdesc id="2">Usage of system resources is monitored by Ceilometer, the standard
        OpenStack mechanism for collecting and distributing performance monitoring samples from the
        cluster. The HP Helion OpenStack Carrier Grade cluster extends Ceilometer with improved reports and new tools
        to facilitate offline analysis of the collected data.</shortdesc>
    <prolog>
        <author id="3">Pedro Sanchez</author>
    </prolog>
    <conbody>
        <p id="4">Performance Monitor (PM) samples are periodically collected from different
            resources such as hosts, virtual machine instances, AVS, and others. They include CPU
            and memory utilization, network traffic counters, storage space, and several more. By
            default the samples are stored in a database which is used for reporting activities such
            as:</p>
        <ul id="ul_pfp_vlr_j4">
            <li id="5">
                <p id="6">command line queries and graphical charts</p>
            </li>
            <li id="7">
                <p id="8">triggering of threshold alarms</p>
            </li>
            <li id="9">
                <p id="10">triggering of threshold actions. The most common example is Heat actions to scale up and
          down a resource.</p>
            </li>
        </ul>
        <p id="11">The Ceilometer database is periodically cleaned in order to contain its size and prevent the
      overuse of storage resources on the controller nodes.</p>
        <p id="12">The Ceilometer implementation in HP Helion OpenStack Carrier Grade improves on several
            aspects. They are described in the following sections.</p>
        <section id="section_N10048_N1001C_N10001" id="13">
            <title id="14">Optimized Ceilometer Filters</title>
            <p id="15">The Ceilometer implementation in HP Helion OpenStack Carrier Grade is specially tuned
                to allow time-sensitive actions, such as Heat autoscaling, to take place in response
                to relatively high-frequency sample rates of system events. The size of both the
                Ceilometer database and the CSV files are maintained under control at all times,
                while still enabling the required system actions to take place in real-time.</p>
        </section>
        <section id="section_N1006E_N1001C_N10001" id="21">
            <title id="22">On-Line Ceilometer Reports</title>
            <p id="23">On-line, on-demand, Ceilometer reports in HP Helion OpenStack Carrier Grade benefit
                from several improvements over the stock OpenStack reporting tool, including:</p>
            <ul id="ul_lfg_pdz_j4">
                <li id="24">
                    <p id="25">optimized Ceilometer database queries</p>
                </li>
                <li id="26">
                    <p id="27">improved naming of menu entries on pull-down menus</p>
                </li>
                <li id="28">
                    <p id="29">use of brief meter descriptions and human-readable legends on
                        the charts</p>
                </li>
            </ul>
            <p id="30">Additionally, all database queries are user-initiated, as opposed to event-initiated. This
        provides a different user workflow, whereby all required report parameters and filters are
        configured first, before the database query is executed</p>
            <p id="31">Access to Ceilometer reports is available from the <uicontrol id="32">Stats</uicontrol> tab on the <wintitle id="33">Resource
                    Usage Overview</wintitle> page. This page can be accessed from the web
                management interface by selecting the option <option id="34">Resource
                    Usage</option> on the <uicontrol id="35">Admin</uicontrol> tab of the
                system panel. The <uicontrol id="36">Stats</uicontrol> tab is presented as
                follows:</p>
            <fig id="fig_N100B3_N1006E_N1001C_N10001" id="37">
                <image href="jow1404333641017.image" id="image_bsy_t3s_j4" id="38" placement="inline" width="4in"/>
            </fig>
            <p id="39">The following fields are available:</p>
            <dl>
                <dlentry id="40">
                    <dt id="41">Metric</dt>
                    <dd id="42">
                        <p id="43">The Ceilometer metric you want to query. Metrics are
                            grouped by service, as follows:</p>
                        <ul id="ul_btj_sjs_j4">
                            <li id="44">
                                <p id="45">Compute (Nova)</p>
                            </li>
                            <li id="46">
                                <p id="47">Network (Neutron)</p>
                            </li>
                            <li id="48">
                                <p id="49">Image (Glance)</p>
                            </li>
                            <li id="50">
                                <p id="51">Volume (Cinder)</p>
                            </li>
                            <li id="56">
                                <p id="57">Switching (AVS)</p>
                            </li>
                        </ul>
                        <p id="58">On the CLI, use the following command to list the available metrics, and find their
              resource IDs:</p>
                        <codeblock id="59"><systemoutput id="229">~(keystone_admin)$ </systemoutput><userinput id="61">ceilometer meter-list</userinput></codeblock>
                    </dd>
                </dlentry>
                <dlentry id="62">
                    <dt id="63">Value</dt>
                    <dd id="64">
                        <p id="65">The particular statistic you want to visualize. Select
                            among <option id="167">Average</option>, <option id="168">Minimum</option>, <option id="169">Maximum</option>, and <option id="170">Summation</option>.</p>
                    </dd>
                </dlentry>
                <dlentry id="66">
                    <dt id="67">Group by</dt>
                    <dd id="68">
                        <p id="69">How to group the displayed charts, as follows:</p>
                        <dl>
                            <dlentry id="70">
                                <dt id="71">None</dt>
                                <dd id="72">
                                    <p id="73">The selected statistic is presented as a single line chart reporting the
                    aggregate over all resources and projects (tenants).</p>
                                </dd>
                            </dlentry>
                            <dlentry id="74">
                                <dt id="75">Projects (Tenants)</dt>
                                <dd id="76">
                                    <p id="77">The selected statistic is presented as a multiple line charts over all
                    resources, one line per tenant.</p>
                                </dd>
                            </dlentry>
                            <dlentry id="78">
                                <dt id="79">Resource</dt>
                                <dd id="80">
                                    <p id="81">The selected statistic is presented as a multiple line charts over all
                    resources, one line per resource (hosts, instances, and so on).</p>
                                </dd>
                            </dlentry>
                        </dl>
                    </dd>
                </dlentry>
                <dlentry id="171">
                    <dt id="172">Period</dt>
                    <dd id="173">
                        <p id="174">The period of time to be covered by the report. They
                            include <option id="197">last 15 minutes</option>, <option id="198">last 30 minutes</option>, <option id="199">last hour</option>, <option id="176">last day</option>,
                                <option id="177">last week</option>, <option id="178">last 15 days</option>, <option id="179">last 30 days</option>, <option id="180">last year</option>,
                            and <option id="181">other</option>. When selecting <option id="182">other</option>, two new fields become available,
                                <option id="183">Date From</option> and <option id="184">Date To</option>, allowing you to specify a
                            specific time period.</p>
                    </dd>
                </dlentry>
                <dlentry id="82">
                    <dt id="83">Metadata</dt>
                    <dd id="84">
                        <p id="85">Metadata represents additional attributes collected with a metric. In this menu, you
              can select the specific attribute you want the report on.</p>
                        <p id="86">The pull-down menu is auto-populated with the corresponding attributes for the
              selected metric. On the CLI, use the following command to list the metadata associated
              with a metric identified with its resource ID:</p>
                        <codeblock id="87"><systemoutput id="230">~(keystone_admin)$ </systemoutput><userinput id="89">ceilometer resource-show    r &lt;resource_id&gt;</userinput></codeblock>
                    </dd>
                </dlentry>
                <dlentry id="90">
                    <dt id="91">Filter</dt>
                    <dd id="92">
                        <p id="93">Use this field to limit the report to show metric samples whose metadata attribute
              equals the specified value. The filter field is applied only when a specific metadata
              attribute is selected.</p>
                    </dd>
                </dlentry>
            </dl>
            <p id="94">Once the selections are in place, click the <option id="95">Report</option> button to display the
        report.</p>
        </section>
        <section id="section_N101AA_N1001C_N10001" id="96">
            <title id="97">CSV Performance Monitoring Backend</title>
            <p id="98">HP Helion OpenStack Carrier Grade provides access to performance measurement samples in
                the form of comma-separated values (CSV) files. They provide the following
                benefits:</p>
            <ul id="ul_dnc_dpz_j4">
                <li id="99">
                    <p id="100">off-line permanent storage of large samples history</p>
                </li>
                <li id="101">
                    <p id="102">enables the use of off-line tools for data analysis, accounting, and archiving</p>
                </li>
            </ul>
            <p id="103">The CSV files are expected to be retrieved from the controllers using any suitable file
        transfer client application such as SFTP or SCP. This can be done manually by the system
        administrator, or automatically by an operations and support server (OSS/BSS) configured
        with the appropriate login credentials.</p>
            <p id="104">Recording of samples and management of CSV files is done through
                special Ceilometer pipelines available from the <uicontrol id="106">Pipelines</uicontrol> tab, as illustrated below:</p>
            <fig id="fig_N101DC_N101AB_N1001C_N10001" id="107">
                <image href="jow1404333642494.image" id="image_dkk_ptz_j4" id="108" placement="inline" width="6in"/>
            </fig>
            <p id="200">The <nameliteral id="201">csv</nameliteral> pipeline collects system information with the
                exception of AVS switching meters. The latter are collected by the
                    <nameliteral id="202">vswitch_avg</nameliteral> pipeline.</p>
            <p id="109">Click the button <uicontrol id="110">Update
                    Settings</uicontrol> to configure the behavior of a pipeline. The <wintitle id="111">Edit Pipeline</wintitle> window is presented as follows:</p>
            <fig id="fig_N101F4_N101AB_N1001C_N10001" id="112">
                <image href="jow1404333644008.image" id="image_ckk_gvz_j4" id="113" placement="inline" width="4in"/>
            </fig>
            <p id="114">The following fields are available:</p>
            <dl>
                <dlentry id="115">
                    <dt id="116">Name</dt>
                    <dd id="117">
                        <p id="118">A read-only field displaying the name of the pipeline</p>
                    </dd>
                </dlentry>
                <dlentry id="119">
                    <dt id="120">Meters</dt>
                    <dd id="121">
                        <p id="122">An editable field displaying the list of comma-separated
                            meters included in the pipeline. The list must be enclosed in square
                            brackets, as follows:</p>
                        <codeblock id="145"><userinput id="146">[meter1,meter2,...]</userinput></codeblock>
                        <p id="147">The following syntax rules apply to the specified meters:</p>
                        <ul id="ul_ipr_k42_1p">
                            <li id="148">
                                <p id="149">A meter specification is a text string of the form
                                        <term id="150">metergroup.metersubgroup.meter</term>, for example,
                                        <userinput id="151">disk.read.bytes</userinput></p>
                            </li>
                            <li id="185">
                                <p id="187">A meter specification supports a trailing wild-card to include
                                    all <term id="189">meters</term> within a <term id="191">metergroup</term>. For
                                    example, the text <userinput id="193">disk.*</userinput> matches the
                                    meters <userinput id="195">disk.read.bytes</userinput> and
                                        <userinput id="158">disk.write.bytes</userinput>.</p>
                            </li>
                            <li id="186">
                                <p id="188">A meter specification supports a trailing
                                    wild-card to include all <term id="190">metersubgroups</term> within a <term id="192">metergroup</term>. For example, the text <userinput id="194">disk.read.*</userinput> matches the meter
                                        <userinput id="196">disk.read.bytes</userinput>.</p>
                            </li>
                            <li id="159">
                                <p id="160">Meter specifications support a leading exclamation mark to
                                    exclude the specified meter, as follows:</p>
                                <codeblock id="161"><userinput id="162">[!meter1,!meter2,...]</userinput></codeblock>
                                <p id="163">Such a pipeline includes all meters but the ones in the list.</p>
                                <p id="164">Exclamation marks cannot be applied selectively in a list of
                                    meters. Either all meters use them or none at all. The following
                                    list is therefore invalid:</p>
                                <codeblock id="165"><userinput id="166">[meter1,!meter2,meter3]</userinput></codeblock>
                            </li>
                        </ul>
                    </dd>
                </dlentry>
                <dlentry id="123">
                    <dt id="124">Location</dt>
                    <dd id="125">
                        <p id="126">The absolute path to the CSV file on the controller.</p>
                    </dd>
                </dlentry>
                <dlentry id="127">
                    <dt id="128">Enabled</dt>
                    <dd id="129">
                        <p id="130">A check box used to enable or disable the pipeline.</p>
                    </dd>
                </dlentry>
                <dlentry id="131">
                    <dt id="132">Max Bytes</dt>
                    <dd id="133">
                        <p id="134">The maximum size, in bytes, of a CSV file. The default value is 10 MB.</p>
                    </dd>
                </dlentry>
                <dlentry id="137">
                    <dt id="138">Backup Count</dt>
                    <dd id="139">
                        <p id="140">The number of concurrent backup CSV files to maintain in a rotation ring, including
              the currently active file. When a CSV file reaches its maximum size, it is renamed as
              a backup file, and a new CSV file is opened for writing. Backup files older than the
              size of the rotation ring are automatically removed.</p>
                    </dd>
                </dlentry>
                <dlentry id="141">
                    <dt id="142">Compress Backups</dt>
                    <dd id="143">
                        <p id="144">A check box used to select whether or not to compress backup files in the rotation
              ring.</p>
                    </dd>
                </dlentry>
            </dl>
        </section>
        <section id="section_N103F2_N1001F_N10001" id="203">
            <title id="204">Retention Period</title>
            <p id="205">Performance samples are kept in the database for a limited period of time known as
                the <term id="206">retention period</term>. Its  default value is 86400 seconds, or 24
                hours.</p>
            <p id="207">Click the <uicontrol id="208">Edit Retention Period</uicontrol> button in the
                    <uicontrol id="209">Retention Period</uicontrol> tab to modify the current value. You
                must ensure that the configured value is equal or higher than the period over which
                you intend to gather statistics.</p>
            <p id="210">You can also control the retention period from the CLI. To view the current settings,
                use the following command.</p>
            <codeblock id="211"><systemoutput id="231">~(keystone_admin)$ </systemoutput><userinput id="213">system pm-show</userinput></codeblock>
            <p id="214">To change the retention period from the CLI, use the following command syntax.</p>
            <codeblock id="215"><systemoutput id="232">~(keystone_admin)$ </systemoutput><userinput id="217">system pm-modify retention_secs=<varname id="218">retention_period</varname></userinput></codeblock>
            <p id="219">For example:</p>
            <codeblock id="220"><systemoutput id="233">~(keystone_admin)$ </systemoutput><userinput id="222">system pm-modify retention_secs=172800</userinput></codeblock>
            <note id="note_N1041B_N103CD_N1001F_N10001" id="223">
                <p id="224">Changes to the retention period cause <nameliteral id="225">250.001 Configuration
                        out-of-date</nameliteral> alarms to be raised briefly for the controller
                    nodes. During this period, the status <nameliteral id="226">Config
                        out-of-date</nameliteral> is displayed for the controller nodes on the
                        <wintitle id="227">Host</wintitle> tab of the <wintitle id="228">Inventory</wintitle> pane.
                    These alarms are resolved and cleared automatically after a few seconds.</p>
            </note>
        </section>
    </conbody>
</concept-wr>