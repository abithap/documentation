<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task-wr PUBLIC "-//WindRiver.com//DTD DITA 1.2 Wind River General Task//EN" "task-wr.dtd">
<task-wr id="jow1425236723556" xml:lang="en-us">
<!-- Modification History
        
-->
    <title id="1">Pinning a Guest NUMA Node to a Host NUMA Node</title>
    <shortdesc id="2">You can use flavor extra specs or image properties to pin a guest NUMA
        node to a host NUMA node.</shortdesc>
    <prolog>
        <author id="3">Jim Owens</author>
    </prolog>
    <taskbody>
        <context id="context_N1001F_N1001C_N10001" id="4">
            <p id="5">By default, when instances are launched or migrated, the virtual NUMA
                nodes defined for the VMs are mapped to available host NUMA nodes. You can
                optionally designate a specific host NUMA node for a virtual NUMA node, using either
                a flavor extra specification (which takes the general form <nameliteral id="93">hw:specification</nameliteral>), or an image property (which
                takes the general form <nameliteral id="94">hw_specification</nameliteral>).
                This enables you to co-locate VM processes with AVS vSwitch processes for
                high-performance networking. </p>
            <p id="72"><!-- For information about exposing multiple NUMA nodes to a VM, see <xref
                    href="jow1425236666266.xml"/>. -->For
                information about assigning vSwitch processes to host NUMA nodes, see <xref href="jow1404333768530.xml" id="73"/>.</p>
            <p id="319">For a VM with only one virtual NUMA node, you can use an extra specification to
                specify the host NUMA node.
                <!--This is the Horizon-based implementation of the old way of assigning NUMA nodes, still extant. Presumably Horizon will be updated later to reflect the changes in NUMA node handling that inspired the current topic and related topics covering US51010. -->
                To add this extra spec to a flavor using the web administration interface, use the
                    <uicontrol id="314">NUMA Node</uicontrol> selection in the <uicontrol id="316">Create Flavor Extra Spec</uicontrol> drop-down menu. This
                provides fields to associate a <uicontrol id="320">Guest NUMA Node</uicontrol> with a
                    <uicontrol id="321">Host NUMA Node</uicontrol>. To access this menu, see <xref href="jow1429538642910.xml" id="318"/>.</p>
            <p id="78">You can also pin NUMA nodes using the CLI.  The following extra
                specification assigns a specific host NUMA node to a virtual NUMA node:</p>
            <codeblock id="52">hw:numa_node.<varname id="53">vnode_id</varname>=<varname id="54">pnode_id</varname></codeblock>
            <p id="55">where</p>
            <parml>
                <plentry id="56">
                    <pt id="57"><parmname id="58">vnode_id</parmname></pt>
                    <pd id="59">
                        <p id="60">is the number used to identify the virtual NUMA node (0
                            for the first node, 1 for the second, and so on).</p>
                    </pd>
                </plentry>
                <plentry id="61">
                    <pt id="62"><parmname id="63">pnode_id</parmname></pt>
                    <pd id="64">
                        <p id="65">is the number used to identify the host NUMA node (0 for
                            the first node, 1 for the second, and so on).</p>
                    </pd>
                </plentry>
            </parml>
            <p id="67">For example, given flavor <nameliteral id="68">numa.pinned.asym</nameliteral>, use the following command to assign virtual
                NUMA node 0 to host NUMA node 1:</p>
            <codeblock id="69"><systemoutput id="70">~(keystone_admin)$ </systemoutput><userinput id="71">nova flavor-key numa.pinned.asym set hw:numa_node.0=1</userinput></codeblock>
        </context>
    </taskbody>
</task-wr>